<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TurnoMed - Mis Ingresos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.css" rel="stylesheet">
    <style>
        /* Paleta de colores lila/celeste */
        :root {
            --color-lila: #9a7bff;
            --color-lila-claro: #e6e6fa;
            --color-lila-oscuro: #6a5acd;
            --color-celeste: #87cefa;
            --color-celeste-claro: #e6f7ff;
            --color-fondo: #f8f9ff;
            --color-texto: #3a3a68;
        }
        
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            justify-content: space-between;
            background-color: var(--color-fondo);
            color: var(--color-texto);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .app-header {
            background: linear-gradient(135deg, var(--color-lila), var(--color-celeste));
            color: white;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .app-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }

        .app-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-container {
            flex-grow: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .salary-section {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .salary-card {
            background: linear-gradient(135deg, var(--color-lila-claro), var(--color-celeste-claro));
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--color-lila);
        }

        .salary-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--color-lila-oscuro);
            margin: 0.5rem 0;
        }

        .salary-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .salary-label {
            font-weight: 600;
            color: var(--color-lila-oscuro);
        }

        .salary-number {
            font-weight: 600;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 2rem;
        }

        .table-responsive {
            margin-top: 1.5rem;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--color-lila-claro);
        }

        th {
            background-color: var(--color-lila-claro);
            color: var(--color-lila-oscuro);
            font-weight: 600;
        }

        tr:hover {
            background-color: var(--color-celeste-claro);
        }

        .month-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .month-title {
            color: var(--color-lila-oscuro);
            font-weight: 600;
            font-size: 1.2rem;
        }

        .btn-month {
            background-color: var(--color-lila);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-month:hover {
            background-color: var(--color-lila-oscuro);
            transform: translateY(-2px);
        }

        .btn-month:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        footer {
            background-color: var(--color-lila-oscuro);
            color: white;
            text-align: center;
            padding: 1rem;
            margin-top: auto;
        }

        h2, h3 {
            color: var(--color-lila-oscuro);
        }

        .info-message {
            background-color: var(--color-celeste-claro);
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--color-celeste);
        }

        @media (max-width: 768px) {
            .salary-details {
                flex-direction: column;
            }
            
            .salary-card {
                padding: 1rem;
            }
            
            .salary-value {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-header">
        <h1 class="app-title">TurnoMed</h1>
        <p class="app-subtitle">Mis Ingresos Mensuales</p>
    </div>

    <div class="main-container">
        <h2>Resumen de Sueldo</h2>
        <p class="text-muted">Visualiza tu sueldo calculado según las horas trabajadas y el valor hora de tu función.</p>

        <!-- Selector de mes -->
        <div class="month-selector">
            <button class="btn-month" id="prevMonth" disabled>
                <i class="fas fa-chevron-left"></i>
            </button>
            <span class="month-title" id="currentMonth">Junio 2023</span>
            <button class="btn-month" id="nextMonth">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <!-- Información del mes actual -->
        <div class="info-message">
            <i class="fas fa-info-circle"></i> Los datos mostrados corresponden a las horas registradas en el sistema. No es posible modificar esta información.
        </div>

        <!-- Resumen de sueldo -->
        <div class="salary-section">
            <h3>Sueldo del Mes</h3>
            
            <div class="salary-card">
                <div class="salary-value" id="netSalary">$1,250,000</div>
                <small class="text-muted">Líquido a pagar</small>
                
                <div class="salary-details mt-4">
                    <div class="salary-detail">
                        <span class="salary-label">Horas trabajadas:</span>
                        <span class="salary-number" id="hoursWorked">150</span>
                    </div>
                    <div class="salary-detail">
                        <span class="salary-label">Valor hora:</span>
                        <span class="salary-number" id="hourValue">$10,000</span>
                    </div>
                    <div class="salary-detail">
                        <span class="salary-label">Sueldo bruto:</span>
                        <span class="salary-number" id="grossSalary">$1,500,000</span>
                    </div>
                    <div class="salary-detail">
                        <span class="salary-label">Descuentos:</span>
                        <span class="salary-number text-danger" id="discounts">$250,000</span>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="salaryChart"></canvas>
            </div>
        </div>

        <!-- Histórico de meses anteriores -->
        <div class="salary-section">
            <h3>Histórico de Ingresos</h3>
            
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Mes/Año</th>
                            <th>Horas</th>
                            <th>Valor Hora</th>
                            <th>Bruto</th>
                            <th>Descuentos</th>
                            <th>Líquido</th>
                        </tr>
                    </thead>
                    <tbody id="salaryHistory">
                        <!-- Datos se llenarán dinámicamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <footer>
        <p>© 2023 TurnoMed - Sistema de Gestión Hospitalaria</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <script>
        // Datos de ejemplo
        const salaryData = {
            '2023-06': {
                hours: 150,
                hourValue: 10000,
                gross: 1500000,
                discounts: 250000,
                net: 1250000
            },
            '2023-05': {
                hours: 140,
                hourValue: 9500,
                gross: 1330000,
                discounts: 213000,
                net: 1117000
            },
            '2023-04': {
                hours: 160,
                hourValue: 9500,
                gross: 1520000,
                discounts: 243200,
                net: 1276800
            },
            '2023-03': {
                hours: 145,
                hourValue: 9000,
                gross: 1305000,
                discounts: 208800,
                net: 1096200
            },
            '2023-02': {
                hours: 135,
                hourValue: 9000,
                gross: 1215000,
                discounts: 194400,
                net: 1020600
            },
            '2023-01': {
                hours: 155,
                hourValue: 8500,
                gross: 1317500,
                discounts: 210800,
                net: 1106700
            }
        };

        // Configurar gráfico
        let salaryChart;
        
        function initChart(data) {
            const ctx = document.getElementById('salaryChart').getContext('2d');
            
            if (salaryChart) {
                salaryChart.destroy();
            }
            
            salaryChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                    datasets: [
                        {
                            label: 'Sueldo Bruto',
                            data: [1317500, 1215000, 1305000, 1520000, 1330000, 1500000],
                            backgroundColor: 'rgba(154, 123, 255, 0.7)',
                            borderColor: 'rgba(154, 123, 255, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Sueldo Líquido',
                            data: [1106700, 1020600, 1096200, 1276800, 1117000, 1250000],
                            backgroundColor: 'rgba(135, 206, 250, 0.7)',
                            borderColor: 'rgba(135, 206, 250, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'k';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': $' + context.raw.toLocaleString('es-CL');
                                }
                            }
                        }
                    }
                }
            });
        }

        // Formatear moneda
        function formatCurrency(amount) {
            return '$' + amount.toLocaleString('es-CL');
        }

        // Actualizar vista con datos del mes seleccionado
        function updateView(monthKey) {
            const data = salaryData[monthKey];
            
            document.getElementById('hoursWorked').textContent = data.hours;
            document.getElementById('hourValue').textContent = formatCurrency(data.hourValue);
            document.getElementById('grossSalary').textContent = formatCurrency(data.gross);
            document.getElementById('discounts').textContent = formatCurrency(data.discounts);
            document.getElementById('netSalary').textContent = formatCurrency(data.net);
            
            // Actualizar título del mes
            const [year, month] = monthKey.split('-');
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                               'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            document.getElementById('currentMonth').textContent = `${monthNames[parseInt(month)-1]} ${year}`;
            
            // Actualizar histórico
            updateHistoryTable();
        }

        // Actualizar tabla histórica
        function updateHistoryTable() {
            const tbody = document.getElementById('salaryHistory');
            tbody.innerHTML = '';
            
            Object.entries(salaryData).forEach(([key, data]) => {
                const [year, month] = key.split('-');
                const monthNames = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 
                                  'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${monthNames[parseInt(month)-1]}/${year}</td>
                    <td>${data.hours}</td>
                    <td>${formatCurrency(data.hourValue)}</td>
                    <td>${formatCurrency(data.gross)}</td>
                    <td>${formatCurrency(data.discounts)}</td>
                    <td><strong>${formatCurrency(data.net)}</strong></td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Navegación entre meses
        let currentMonth = '2023-06';
        
        document.getElementById('prevMonth').addEventListener('click', function() {
            const [year, month] = currentMonth.split('-');
            let prevYear = parseInt(year);
            let prevMonth = parseInt(month) - 1;
            
            if (prevMonth < 1) {
                prevMonth = 12;
                prevYear--;
            }
            
            currentMonth = `${prevYear}-${prevMonth.toString().padStart(2, '0')}`;
            
            if (salaryData[currentMonth]) {
                updateView(currentMonth);
                document.getElementById('nextMonth').disabled = false;
            } else {
                document.getElementById('prevMonth').disabled = true;
            }
        });
        
        document.getElementById('nextMonth').addEventListener('click', function() {
            const [year, month] = currentMonth.split('-');
            let nextYear = parseInt(year);
            let nextMonth = parseInt(month) + 1;
            
            if (nextMonth > 12) {
                nextMonth = 1;
                nextYear++;
            }
            
            currentMonth = `${nextYear}-${nextMonth.toString().padStart(2, '0')}`;
            
            if (salaryData[currentMonth]) {
                updateView(currentMonth);
                document.getElementById('prevMonth').disabled = false;
            } else {
                document.getElementById('nextMonth').disabled = true;
            }
        });

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            updateView(currentMonth);
            initChart();
        });
    </script>
</body>
</html>
